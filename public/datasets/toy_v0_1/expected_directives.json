{
  "schema_version": "v0.1",
  "dataset_id": "toy_v0_1",
  "engine_version": "directive-engine/0.1.0",
  "generated_at": "2025-12-27T12:00:01Z",
  "inputs": {
    "nominal_poses": "data/toy_nominal_poses.json",
    "as_built_poses": "data/toy_asbuilt_poses.json",
    "constraints": "data/toy_constraints.json",
    "confidence_threshold": 0.7
  },
  "summary": {
    "counts_by_status": {
      "ok": 1,
      "pending": 3,
      "clamped": 1,
      "blocked": 1,
      "needs_review": 1
    }
  },
  "steps": [
    {
      "step_id": "S1",
      "part_id": "P1",
      "status": "ok",
      "reason_codes": ["within_tolerance"],
      "pose_confidence": 0.95,
      "computed_errors": {
        "translation_error_mm_vec": [0, 0, 0],
        "translation_error_norm_mm": 0.0,
        "rotation_error_deg": 0.0
      },
      "actions": [
        {
          "action_id": "A1",
          "type": "noop",
          "description": "No adjustment required; as-built pose is within tolerance.",
          "delta": {
            "translation_mm": [0, 0, 0],
            "rotation_quat_xyzw": [0, 0, 0, 1]
          }
        }
      ],
      "verification": [
        {
          "verification_id": "V1",
          "type": "measure_pose",
          "acceptance": { "translation_mm": 0.5, "rotation_deg": 1.0 },
          "expected_residual": { "translation_mm_vec": [0, 0, 0], "rotation_deg": 0.0 },
          "expected_result": "expected_pass",
          "notes": "Confirm base reference remained stable."
        }
      ]
    },
    {
      "step_id": "S2",
      "part_id": "P2",
      "status": "pending",
      "reason_codes": ["translation_out_of_tolerance", "translate_only"],
      "pose_confidence": 0.9,
      "computed_errors": {
        "translation_error_mm_vec": [-2.5, 1.0, 0.0],
        "translation_error_norm_mm": 2.6925824036,
        "rotation_error_deg": 0.0
      },
      "actions": [
        {
          "action_id": "A2",
          "type": "translate",
          "description": "Translate guide_rail to nominal (rotation locked). Apply delta in world frame.",
          "delta": {
            "translation_mm": [-2.5, 1.0, 0.0],
            "rotation_quat_xyzw": [0, 0, 0, 1]
          },
          "clamp_applied": false
        }
      ],
      "verification": [
        {
          "verification_id": "V2",
          "type": "measure_pose",
          "acceptance": { "translation_mm": 1.0, "rotation_deg": 1.0 },
          "expected_residual": { "translation_mm_vec": [0, 0, 0], "rotation_deg": 0.0 },
          "expected_result": "expected_pass",
          "notes": "Re-measure pose after translation; ensure rotation unchanged."
        }
      ]
    },
    {
      "step_id": "S3",
      "part_id": "P3",
      "status": "clamped",
      "reason_codes": ["translation_out_of_tolerance", "clamped_to_limits", "translate_clamped"],
      "pose_confidence": 0.88,
      "computed_errors": {
        "translation_error_mm_vec": [-10.0, 5.0, 0.0],
        "translation_error_norm_mm": 11.1803398875,
        "rotation_error_deg": 0.0
      },
      "actions": [
        {
          "action_id": "A3",
          "type": "translate",
          "description": "Translate sensor_bracket toward nominal but clamp to per-axis max abs limits (Â±5 mm).",
          "delta": {
            "translation_mm": [-5.0, 5.0, 0.0],
            "rotation_quat_xyzw": [0, 0, 0, 1]
          },
          "clamp_applied": true,
          "original_delta": {
            "translation_mm": [-10.0, 5.0, 0.0],
            "rotation_quat_xyzw": [0, 0, 0, 1]
          }
        }
      ],
      "verification": [
        {
          "verification_id": "V3",
          "type": "measure_pose",
          "acceptance": { "translation_mm": 5.0, "rotation_deg": 2.0 },
          "expected_residual": { "translation_mm_vec": [-5.0, 0.0, 0.0], "rotation_deg": 0.0 },
          "expected_result": "expected_pass",
          "notes": "Residual translation equals tolerance boundary; record as clamped move."
        }
      ]
    },
    {
      "step_id": "S4",
      "part_id": "P4",
      "status": "pending",
      "reason_codes": ["rotation_out_of_tolerance", "index_rotation"],
      "pose_confidence": 0.92,
      "computed_errors": {
        "translation_error_mm_vec": [0, 0, 0],
        "translation_error_norm_mm": 0.0,
        "rotation_error_deg": 30.0
      },
      "actions": [
        {
          "action_id": "A4",
          "type": "rotate_to_index",
          "description": "Rotate dial_knob to target detent index 0 about +Z (nominal index).",
          "axis": "z",
          "target_index": 0,
          "delta": {
            "translation_mm": [0, 0, 0],
            "rotation_quat_xyzw": [0.0, 0.0, -0.2588190451, 0.9659258263]
          },
          "clamp_applied": false
        }
      ],
      "verification": [
        {
          "verification_id": "V4",
          "type": "manual_inspection",
          "acceptance": { "translation_mm": 1.0, "rotation_deg": 2.0 },
          "expected_residual": { "translation_mm_vec": [0, 0, 0], "rotation_deg": 0.0 },
          "expected_result": "expected_pass",
          "notes": "Confirm knob is seated at detent (index 0)."
        }
      ]
    },
    {
      "step_id": "S5",
      "part_id": "P5",
      "status": "blocked",
      "reason_codes": ["outside_limits_blocked", "translation_exceeds_max_norm"],
      "pose_confidence": 0.85,
      "computed_errors": {
        "translation_error_mm_vec": [-30.0, -60.0, 0.0],
        "translation_error_norm_mm": 67.0820393249,
        "rotation_error_deg": 0.0
      },
      "actions": [],
      "verification": [
        {
          "verification_id": "V5",
          "type": "manual_inspection",
          "acceptance": { "translation_mm": 2.0, "rotation_deg": 1.0 },
          "expected_residual": { "translation_mm_vec": [-30.0, -60.0, 0.0], "rotation_deg": 0.0 },
          "expected_result": "expected_fail",
          "notes": "Required translation exceeds translation_max_norm_mm=20; do not attempt correction; escalate."
        }
      ]
    },
    {
      "step_id": "S6",
      "part_id": "P6",
      "status": "needs_review",
      "reason_codes": ["low_confidence"],
      "pose_confidence": 0.45,
      "computed_errors": {
        "translation_error_mm_vec": [-2.0, -1.0, 0.0],
        "translation_error_norm_mm": 2.2360679775,
        "rotation_error_deg": 0.0
      },
      "actions": [
        {
          "action_id": "A6",
          "type": "noop",
          "description": "Do not move part: pose confidence below threshold. Request re-scan.",
          "delta": {
            "translation_mm": [0, 0, 0],
            "rotation_quat_xyzw": [0, 0, 0, 1]
          }
        }
      ],
      "verification": [
        {
          "verification_id": "V6",
          "type": "re_scan",
          "acceptance": { "translation_mm": 1.5, "rotation_deg": 2.0 },
          "expected_residual": { "translation_mm_vec": [-2.0, -1.0, 0.0], "rotation_deg": 0.0 },
          "expected_result": "unknown",
          "notes": "Re-scan to improve confidence >= 0.7 before issuing motion directives."
        }
      ]
    },
    {
      "step_id": "S7",
      "part_id": "P7",
      "status": "pending",
      "reason_codes": ["rotation_out_of_tolerance", "rotation_free_single_axis"],
      "pose_confidence": 0.9,
      "computed_errors": {
        "translation_error_mm_vec": [0, 0, 0],
        "translation_error_norm_mm": 0.0,
        "rotation_error_deg": 5.0
      },
      "actions": [
        {
          "action_id": "A7",
          "type": "rotate",
          "description": "Rotate latch about +X hinge axis back to nominal.",
          "axis": "x",
          "delta": {
            "translation_mm": [0, 0, 0],
            "rotation_quat_xyzw": [-0.0436193874, 0.0, 0.0, 0.9990482216]
          },
          "clamp_applied": false
        }
      ],
      "verification": [
        {
          "verification_id": "V7",
          "type": "measure_pose",
          "acceptance": { "translation_mm": 1.0, "rotation_deg": 1.0 },
          "expected_residual": { "translation_mm_vec": [0, 0, 0], "rotation_deg": 0.0 },
          "expected_result": "expected_pass",
          "notes": "Verify rotation about X only; no translation allowed."
        }
      ]
    }
  ]
}

